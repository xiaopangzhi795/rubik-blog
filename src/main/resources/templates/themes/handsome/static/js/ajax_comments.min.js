var $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');
var comments_order = 'DESC',
    comment_list = '.comment-list',
    comments = '#comments .comments-title',
    comment_reply = '.comment-reply',
    comment_form = '#comment-form',
    respond = '#comments',
    textarea = '#comment',
    submit_btn = '#submit',
    new_id = '',
    parent_id = '';

function msg_effect(id) { // 出错
    $(submit_btn).attr('disabled', false).fadeTo('', 1);
}

function ajaxc(action_url) {

    $(submit_btn).attr('disabled', true).fadeTo('slow', 0.5);

    /* 预检 */
    if ($(comment_form).find('#author')[0]) {

        if ($(comment_form).find('#author').val() == '') {
            toastr.error(nameInfo);
            msg_effect('#error');
            return false;
        }

        if ($(comment_form).find('#mail').val() == '') {
            toastr.error(emailInfo);
            msg_effect('#error');
            return false;
        }

        var filter = /^[^@\s<&>]+@([a-z0-9]+\.)+[a-z]{2,4}$/i;
        if (!filter.test($(comment_form).find('#mail').val())) {
            toastr.error(email_legal_Info);
            msg_effect('#error');
            return false;
        }
    }
    var textValue = $(comment_form).find(textarea).val().replace(/(^\s*)|(\s*$)/g, "");//检查空格信息
    if (textValue == null || textValue == "") {
        toastr.error(contentInfo);
        msg_effect('#error');
        return false;
    }
    $(submit_btn).addClass("active");
    $('#spin').addClass("show inline");
    $.ajax({
        url: action_url,
        type: $(comment_form).attr('method'),
        data: $(comment_form).serializeArray(),
        error: function() {
            toastr.error(submitError);
            $(submit_btn).removeClass("active");
            $('#spin').removeClass("show inline");
            msg_effect('#error');
            return false;
        },
        success: function(data) { //成功取到数据
            $(submit_btn).removeClass("active");
            $('#spin').removeClass("show inline");
            window.location.reload();
            return false;
        }
    });
    return false;
}